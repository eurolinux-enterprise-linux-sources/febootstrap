.\" Automatically generated by Pod::Man 2.22 (Pod::Simple 3.07)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "FEBOOTSTRAP 8"
.TH FEBOOTSTRAP 8 "2010-09-17" "febootstrap-2.9" "Virtualization Support"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
febootstrap \- Bootstrap a basic Fedora system (like Debian debootstrap)
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 1
\& febootstrap [\-\-options] REPO TARGET [MIRROR]
.Ve
.SH "EXAMPLES"
.IX Header "EXAMPLES"
.Vb 4
\& febootstrap fedora\-10 /tmp/f10
\& febootstrap rawhide /tmp/rawhide
\& febootstrap rawhide /tmp/rawhide http://mymirror/rawhide/x86_64/os
\& febootstrap \-\-groupinstall="Mail Server" fedora\-10 /tmp/mailserver
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
febootstrap creates a Fedora root filesystem, based on the Fedora
version specified by \fI\s-1REPO\s0\fR under the directory specified by
\&\fI\s-1TARGET\s0\fR.  Optionally \fI\s-1MIRROR\s0\fR can point to a local mirror
(otherwise the public Fedora mirrors are used).  \fI\s-1REPO\s0\fR names are
\&\f(CW\*(C`fedora\-\f(CIVERSION\f(CW\*(C'\fR (eg. \f(CW\*(C`fedora\-10\*(C'\fR) or \f(CW\*(C`rawhide\*(C'\fR.
.PP
febootstrap does \fInot\fR need to be run as root.  If for some reason
you do run it as root, then it works slightly differently and may have
side effects such as stopping or starting system daemons.
.PP
For more advanced needs, take a look at \fImock\fR\|(1), \f(CW\*(C`livecd\-creator\*(C'\fR
and \fIthincrust.net\fR's \f(CW\*(C`appliance\-creator\*(C'\fR.
.PP
The normal output is a root directory located at \fI\s-1TARGET\s0\fR and
a fakeroot logfile at \f(CW\*(C`\f(CITARGET\f(CW/fakeroot.log\*(C'\fR.
.SH "OPTIONS"
.IX Header "OPTIONS"
.IP "\fB\-i package\fR" 4
.IX Item "-i package"
.PD 0
.IP "\fB\-\-install=package\fR" 4
.IX Item "--install=package"
.ie n .IP "\fB\-g ""group""\fR" 4
.el .IP "\fB\-g ``group''\fR" 4
.IX Item "-g group"
.ie n .IP "\fB\-\-groupinstall=""group""\fR" 4
.el .IP "\fB\-\-groupinstall=``group''\fR" 4
.IX Item "--groupinstall=group"
.PD
Specify the package or group to install.  To list multiple packages or
groups, you must give multiple \f(CW\*(C`\-i\*(C'\fR or \f(CW\*(C`\-g\*(C'\fR options.  Group names
can contain spaces, so use quotes where necessary.
.Sp
These are passed directly to \f(CW\*(C`yum install\*(C'\fR or \f(CW\*(C`yum groupinstall\*(C'\fR
commands, and thus any dependencies are also resolved by yum.  You can
also use shell globs and filenames here, as with ordinary yum.
.Sp
If no packages or groups are given, then we install the \f(CW\*(C`Core\*(C'\fR group
which is a small working Fedora installation (but by no means
minimal).  Use \f(CW\*(C`yum groupinfo Core\*(C'\fR to list the packages currently in
the \f(CW\*(C`Core\*(C'\fR group.
.IP "\fB\-\-no\-clean\fR" 4
.IX Item "--no-clean"
Normally febootstrap will clean up the yum repository
(\f(CW\*(C`/var/cache/yum\*(C'\fR inside the image).  This contains the downloaded
RPMs and metadata.  However if you give the \f(CW\*(C`\-\-no\-clean\*(C'\fR option, then
the yum repository is left.  This is useful if you want to run further
yum commands inside the filesystem by hand.
.ie n .IP "\fB\-p ""proxyurl""\fR" 4
.el .IP "\fB\-p ``proxyurl''\fR" 4
.IX Item "-p proxyurl"
.PD 0
.ie n .IP "\fB\-\-proxy=""proxyurl""\fR" 4
.el .IP "\fB\-\-proxy=``proxyurl''\fR" 4
.IX Item "--proxy=proxyurl"
.PD
\&\s-1URL\s0 to the proxy server that yum should use.
.IP "\fB\-u source\fR" 4
.IX Item "-u source"
.PD 0
.IP "\fB\-\-updates=source\fR" 4
.IX Item "--updates=source"
.PD
Pull in updates from an additional updates repository.  The possible
sources are:
.RS 4
.ie n .IP "\-u ""http://..."" (a \s-1URL\s0)" 4
.el .IP "\-u \f(CWhttp://...\fR (a \s-1URL\s0)" 4
.IX Item "-u http://... (a URL)"
Get updates from the specific \s-1URL\s0.
.ie n .IP "\-u ""updates\-released\-fN"" (an updates repository name)" 4
.el .IP "\-u \f(CWupdates\-released\-fN\fR (an updates repository name)" 4
.IX Item "-u updates-released-fN (an updates repository name)"
Get updates from the public mirrors of the named repository
(eg. \f(CW\*(C`updates\-released\-f10\*(C'\fR).  See \s-1REPOSITORIES\s0 below.
.ie n .IP "\-u ""none"" (default)" 4
.el .IP "\-u \f(CWnone\fR (default)" 4
.IX Item "-u none (default)"
Don't add an updates repository.  This is the default.
.RE
.RS 4
.RE
.SH "REPOSITORIES"
.IX Header "REPOSITORIES"
You can list available repositories by visiting this \s-1URL:\s0
.PP
<http://mirrors.fedoraproject.org/mirrorlist?repo=help&arch=i386>
.PP
(If necessary replace \f(CW\*(C`i386\*(C'\fR with your architecture, but it seems
unlikely that this list will change based on architecture).
.SH "RUNNING EXTRA COMMANDS IN THE ROOT FILESYSTEM"
.IX Header "RUNNING EXTRA COMMANDS IN THE ROOT FILESYSTEM"
If you want to run further commands inside the root filesystem, for
example additional \f(CW\*(C`yum\*(C'\fR installs, then use \f(CW\*(C`febootstrap\-run\*(C'\fR.  See
the \fIfebootstrap\-run\fR\|(8) manual page for more details.
.PP
You have to be careful about modifying files in the root filesystem
directly (without using \f(CW\*(C`febootstrap\-run\*(C'\fR).  It's easy to confuse
fakeroot and end up with the wrong permissions on files (see \s-1FAKEROOT\s0
\&\s-1LOGFILE\s0 below).
.PP
\&\f(CW\*(C`febootstrap\-run\*(C'\fR runs the command inside the root filesystem, which
means it won't normally have access to files outside the root.  You
can use \f(CW\*(C`FAKECHROOT_EXCLUDE_PATH\*(C'\fR environment variable (see
\&\fIfakechroot\fR\|(1)) or copy files into the root first.
.SS "\s-1FAKEROOT\s0 \s-1LOGFILE\s0"
.IX Subsection "FAKEROOT LOGFILE"
When febootstrap is run as non-root (the normal case) we use fakeroot
so that yum thinks it is running as root.  Fakeroot keeps track of
\&\*(L"real\*(R" file permissions in a log file which is saved into the target
directory as \f(CW\*(C`\f(CITARGET\f(CW/fakeroot.log\*(C'\fR.
.PP
This logfile is indexed by inode number, which makes certain
operations safe and other operations unsafe.
Files should be replaced only by doing:
.PP
.Vb 1
\& echo updated\-content > old\-file
.Ve
.PP
(since that preserves the original inode).
.PP
Deleting files and then creating new ones (even with a different name)
is usually unsafe, because the new files might reuse inodes claimed by
the old files, and so appear with peculiar permissions
(eg. unreadable, or as a symbolic link).
.PP
Deleting files is also usually unsafe, although the reasons are more
subtle.  If you just use \f(CW\*(C`rm\*(C'\fR then the inode number is not deleted
from \f(CW\*(C`fakeroot.log\*(C'\fR which means it can be reused by another file
later on.
.PP
In most cases it's usually safest to use \f(CW\*(C`febootstrap\-run\*(C'\fR.
.PP
You can use the fakeroot logfile in a number of ways:
.IP "\(bu" 4
Use \fIfebootstrap\-run\fR\|(8) to run a command with the faked file
permissions.
.IP "\(bu" 4
Use \fIfebootstrap\-install\fR\|(8) to install a file with permissions
in the root filesystem.
.IP "\(bu" 4
Generate an initramfs (compressed cpio) file containing the correct
permissions using the tool \f(CW\*(C`febootstrap\-to\-initramfs\*(C'\fR.
.IP "\(bu" 4
Generate a supermin appliance using the tool
\&\f(CW\*(C`febootstrap\-to\-supermin\*(C'\fR.
.IP "\(bu" 4
Apply the permissions to the target directory using the forthcoming
tool \f(CW\*(C`febootstrap\-fix\-root\*(C'\fR (requires root).
.SH "RUNNING FEBOOTSTRAP AS ROOT"
.IX Header "RUNNING FEBOOTSTRAP AS ROOT"
There is some rudimentary support for running \f(CW\*(C`febootstrap\*(C'\fR as root.
However it is not well-tested and generally not recommended.
.SH "COMPARISON TO DEBOOTSTRAP"
.IX Header "COMPARISON TO DEBOOTSTRAP"
febootstrap cannot do cross-architecture installs (\f(CW\*(C`debootstrap
\&\-\-foreign\*(C'\fR).  The reason is that \f(CW%pre\fR and \f(CW%post\fR scripts cannot
run.  It may be possible to defer running of scriptlets (which is
basically how debootstrap works), and patches to do this are welcomed.
.PP
febootstrap cannot do 32\-on\-64 bit installs.  The reason is that
fakeroot and fakechroot do not load the correct preload library.  This
is really a bug in fakeroot/fakechroot, which we think would be easy
to fix.  (debootstrap deals with this case the same as for
\&\f(CW\*(C`\-\-foreign\*(C'\fR installs \- see previous point).
.SH "OTHER RESTRICTIONS AND BUGS"
.IX Header "OTHER RESTRICTIONS AND BUGS"
The following programs are not run during \f(CW%post\fR scriptlets (because
they are all statically linked, and fakechroot cannot run statically
linked programs).
.ie n .IP """/sbin/ldconfig"" (from many packages)" 4
.el .IP "\f(CW/sbin/ldconfig\fR (from many packages)" 4
.IX Item "/sbin/ldconfig (from many packages)"
.PD 0
.ie n .IP """/usr/sbin/glibc_post_upgrade"" (from ""glibc"")" 4
.el .IP "\f(CW/usr/sbin/glibc_post_upgrade\fR (from \f(CWglibc\fR)" 4
.IX Item "/usr/sbin/glibc_post_upgrade (from glibc)"
.ie n .IP """/usr/sbin/build\-locale\-archive"" (from ""glibc\-common"")" 4
.el .IP "\f(CW/usr/sbin/build\-locale\-archive\fR (from \f(CWglibc\-common\fR)" 4
.IX Item "/usr/sbin/build-locale-archive (from glibc-common)"
.ie n .IP """/usr/sbin/libgcc_post_upgrade"" (from ""libgcc"")" 4
.el .IP "\f(CW/usr/sbin/libgcc_post_upgrade\fR (from \f(CWlibgcc\fR)" 4
.IX Item "/usr/sbin/libgcc_post_upgrade (from libgcc)"
.PD
.PP
If you wish, you can run them the first time you boot into the new
machine.
.PP
febootstrap recreates the repository anew each time, and this causes
yum to download all the RPMs every time.  This is very wasteful, and
we should provide a way to cache the repository.
.SH "HOME PAGE"
.IX Header "HOME PAGE"
<http://people.redhat.com/~rjones/febootstrap>
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIfebootstrap\-to\-initramfs\fR\|(8),
\&\fIfebootstrap\-minimize\fR\|(8),
\&\fIfebootstrap\-run\fR\|(8),
\&\fIfebootstrap\-install\fR\|(8),
\&\fIfebootstrap\-to\-supermin\fR\|(8),
\&\fIfakeroot\fR\|(1),
\&\fIfakechroot\fR\|(1),
\&\fIyum\fR\|(8),
\&\fIrpm\fR\|(8).
.SH "ALTERNATIVES"
.IX Header "ALTERNATIVES"
\&\fImock\fR\|(1),
<http://fedoraproject.org/wiki/FedoraLiveCD/LiveCDHowTo>,
<http://thincrust.net/>,
\&\fIdebootstrap\fR\|(8),
\&\f(CW\*(C`ubuntu\-vm\-builder\*(C'\fR.
.SH "AUTHORS"
.IX Header "AUTHORS"
Richard W.M. Jones <rjones @ redhat . com>
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
(C) Copyright 2009 Red Hat Inc.,
<http://people.redhat.com/~rjones/febootstrap>.
.PP
This program is free software; you can redistribute it and/or modify
it under the terms of the \s-1GNU\s0 General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.
.PP
This program is distributed in the hope that it will be useful,
but \s-1WITHOUT\s0 \s-1ANY\s0 \s-1WARRANTY\s0; without even the implied warranty of
\&\s-1MERCHANTABILITY\s0 or \s-1FITNESS\s0 \s-1FOR\s0 A \s-1PARTICULAR\s0 \s-1PURPOSE\s0.  See the
\&\s-1GNU\s0 General Public License for more details.
.PP
You should have received a copy of the \s-1GNU\s0 General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 675 Mass Ave, Cambridge, \s-1MA\s0 02139, \s-1USA\s0.
